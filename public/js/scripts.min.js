!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){n(6),n(1)},function(t,e,n){(function(t){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}var r=n(2),o=e(r),a=React.createClass({displayName:"Comment",render:function(){return React.createElement("div",{className:"comment"},React.createElement("p",null,this.props.author," says - ",this.props.children))}}),i=React.createClass({displayName:"CommentList",render:function(){var t=this.props.data.map(function(t){return React.createElement(a,{author:t.author,key:t.id},t.text)});return React.createElement("div",{className:"commentList"},t)}}),s=React.createClass({displayName:"CommentForm",getInitialState:function(){return{author:"",text:""}},handleAuthorChange:function(t){this.setState({author:t.target.value})},handleTextChange:function(t){this.setState({text:t.target.value})},handleSubmit:function(e){console.log("test node dev: "+t.env.NODE_ENV),e.preventDefault();var n=this.state.author.trim(),r=this.state.text.trim();if(r&&n){var o=Date.now();this.props.onContentSubmit({id:o.toString(),author:n,text:r}),this.setState({author:"",text:""})}},render:function(){return React.createElement("form",{className:"commentForm",onSubmit:this.handleSubmit},React.createElement("input",{type:"text",placeholder:"Your name",value:this.state.author,onChange:this.handleAuthorChange}),React.createElement("input",{type:"text",placeholder:"What you want to say...",value:this.state.text,onChange:this.handleTextChange}),React.createElement("input",{type:"submit",value:"Post"}))}}),c=React.createClass({displayName:"CommentBox",loadCommentsFromServer:function(){$.ajax({url:this.props.url,dataType:"json",cache:!1,success:function(t){console.log(t),this.setState({data:t})}.bind(this),error:function(t,e,n){console.error(this.props.url,e,n.toString())}.bind(this)})},handleCommentSubmit:function(t){this.state.data.splice(0,0,t),this.state.data.splice(-1,1),$.ajax({url:this.props.sendCommentUrl,dataType:"json",type:"POST",data:(0,o.default)(this.state.data),contentType:"application/json",success:function(t){console.log(t),console.log("After sending "+(0,o.default)(this.state.data))}.bind(this),error:function(t,e,n){console.error(this.props.sendCommentUrl,e,n.toString())}.bind(this)})},getInitialState:function(){return{data:[]}},componentDidMount:function(){this.loadCommentsFromServer(),setInterval(this.loadCommentsFromServer,this.props.pollInterval)},render:function(){return React.createElement("div",{className:"commentBox"},React.createElement("h1",null,"Have your say"),React.createElement(s,{onContentSubmit:this.handleCommentSubmit}),React.createElement(i,{data:this.state.data}))}});ReactDOM.render(React.createElement(c,{url:"https://s3-eu-west-1.amazonaws.com/thepollenreport/comments.json",sendCommentUrl:"http://localhost:3000/api/v1/comments",pollInterval:2e3}),document.getElementById("comments"))}).call(e,n(5))},function(t,e,n){t.exports={default:n(3),__esModule:!0}},function(t,e,n){var r=n(4),o=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return o.stringify.apply(o,arguments)}},function(t,e){var n=t.exports={version:"2.6.1"};"number"==typeof __e&&(__e=n)},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function a(t){if(m===clearTimeout)return clearTimeout(t);if((m===r||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(t);try{return m(t)}catch(e){try{return m.call(null,t)}catch(e){return m.call(this,t)}}}function i(){f&&p&&(f=!1,p.length?d=p.concat(d):v=-1,d.length&&s())}function s(){if(!f){var t=o(i);f=!0;for(var e=d.length;e;){for(p=d,d=[];++v<e;)p&&p[v].run();v=-1,e=d.length}p=null,f=!1,a(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var l,m,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{m="function"==typeof clearTimeout?clearTimeout:r}catch(t){m=r}}();var p,d=[],f=!1,v=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new c(t,e)),1!==d.length||f||o(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e){$(document).ready(function(){$.get("https://s3-eu-west-1.amazonaws.com/thepollenreport/pollen.json").done(function(t){t=JSON.parse(t);const e=t.count;$(".mega").text(e)}).fail(function(){$(".mega").text("Unknown"),$(".main").append("<p>Refresh to try again</p>")}).always(function(){})})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc2NyaXB0cy5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIDY0ZGZkNjgxY2FlNThiZTM4ZTVhIiwid2VicGFjazovLy8uL3B1YmxpYy9qcy9zY3JpcHRzLmpzIiwid2VicGFjazovLy8uL3B1YmxpYy9qcy9jb21tZW50Ym94LmpzIiwid2VicGFjazovLy8uL34vYmFiZWwtcnVudGltZS9jb3JlLWpzL2pzb24vc3RyaW5naWZ5LmpzIiwid2VicGFjazovLy8uL34vY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5LmpzIiwid2VicGFjazovLy8uL34vY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2NvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vcHVibGljL2pzL21haW4uanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwicHJvY2VzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9zdHJpbmdpZnkiLCJfc3RyaW5naWZ5MiIsIkNvbW1lbnQiLCJSZWFjdCIsImNyZWF0ZUNsYXNzIiwiZGlzcGxheU5hbWUiLCJyZW5kZXIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwidGhpcyIsInByb3BzIiwiYXV0aG9yIiwiY2hpbGRyZW4iLCJDb21tZW50TGlzdCIsImNvbW1lbnROb2RlcyIsImRhdGEiLCJtYXAiLCJjb21tZW50Iiwia2V5IiwidGV4dCIsIkNvbW1lbnRGb3JtIiwiZ2V0SW5pdGlhbFN0YXRlIiwiaGFuZGxlQXV0aG9yQ2hhbmdlIiwiZSIsInNldFN0YXRlIiwidGFyZ2V0IiwidmFsdWUiLCJoYW5kbGVUZXh0Q2hhbmdlIiwiaGFuZGxlU3VibWl0IiwiY29uc29sZSIsImxvZyIsImVudiIsIk5PREVfRU5WIiwicHJldmVudERlZmF1bHQiLCJzdGF0ZSIsInRyaW0iLCJEYXRlIiwibm93Iiwib25Db250ZW50U3VibWl0IiwidG9TdHJpbmciLCJvblN1Ym1pdCIsInR5cGUiLCJwbGFjZWhvbGRlciIsIm9uQ2hhbmdlIiwiQ29tbWVudEJveCIsImxvYWRDb21tZW50c0Zyb21TZXJ2ZXIiLCIkIiwiYWpheCIsInVybCIsImRhdGFUeXBlIiwiY2FjaGUiLCJzdWNjZXNzIiwiYmluZCIsImVycm9yIiwieGhyIiwic3RhdHVzIiwiZXJyIiwiaGFuZGxlQ29tbWVudFN1Ym1pdCIsInNwbGljZSIsInNlbmRDb21tZW50VXJsIiwiY29udGVudFR5cGUiLCJjb21wb25lbnREaWRNb3VudCIsInNldEludGVydmFsIiwicG9sbEludGVydmFsIiwiUmVhY3RET00iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29yZSIsIiRKU09OIiwiSlNPTiIsInN0cmluZ2lmeSIsIml0IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJ2ZXJzaW9uIiwiX19lIiwiZGVmYXVsdFNldFRpbW91dCIsIkVycm9yIiwiZGVmYXVsdENsZWFyVGltZW91dCIsInJ1blRpbWVvdXQiLCJmdW4iLCJjYWNoZWRTZXRUaW1lb3V0Iiwic2V0VGltZW91dCIsInJ1bkNsZWFyVGltZW91dCIsIm1hcmtlciIsImNhY2hlZENsZWFyVGltZW91dCIsImNsZWFyVGltZW91dCIsImNsZWFuVXBOZXh0VGljayIsImRyYWluaW5nIiwiY3VycmVudFF1ZXVlIiwibGVuZ3RoIiwicXVldWUiLCJjb25jYXQiLCJxdWV1ZUluZGV4IiwiZHJhaW5RdWV1ZSIsInRpbWVvdXQiLCJsZW4iLCJydW4iLCJJdGVtIiwiYXJyYXkiLCJub29wIiwibmV4dFRpY2siLCJhcmdzIiwiQXJyYXkiLCJpIiwicHVzaCIsInByb3RvdHlwZSIsInRpdGxlIiwiYnJvd3NlciIsImFyZ3YiLCJ2ZXJzaW9ucyIsIm9uIiwiYWRkTGlzdGVuZXIiLCJvbmNlIiwib2ZmIiwicmVtb3ZlTGlzdGVuZXIiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJlbWl0IiwicHJlcGVuZExpc3RlbmVyIiwicHJlcGVuZE9uY2VMaXN0ZW5lciIsImxpc3RlbmVycyIsIm5hbWUiLCJiaW5kaW5nIiwiY3dkIiwiY2hkaXIiLCJkaXIiLCJ1bWFzayIsInJlYWR5IiwiZ2V0IiwiZG9uZSIsInBhcnNlIiwicG9sbGVuIiwiY291bnQiLCJmYWlsIiwiYXBwZW5kIiwiYWx3YXlzIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBRSxXQUNBRSxHQUFBSixFQUNBSyxRQUFBLEVBVUEsT0FOQVAsR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsUUFBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQXFDQSxPQVRBRixHQUFBUSxFQUFBVCxFQUdBQyxFQUFBUyxFQUFBUCxFQUdBRixFQUFBVSxFQUFBLEdBR0FWLEVBQUEsS0RNTSxTQUFVSSxFQUFRRCxFQUFTSCxHRTVDakNBLEVBQUEsR0FDQUEsRUFBQSxJRm1ETSxTQUFVSSxFQUFRRCxFQUFTSCxJQUVKLFNBQVNXLEdBQVUsWUFNL0MsU0FBU0MsR0FBdUJDLEdBQU8sTUFBT0EsSUFBT0EsRUFBSUMsV0FBYUQsR0FBUUUsUUFBU0YsR0FKdkYsR0FBSUcsR0FBYWhCLEVBQW9CLEdBRWpDaUIsRUFBY0wsRUFBdUJJLEdHdkRwQ0UsRUFBVUMsTUFBTUMsYUFBWUMsWUFBQSxVQUNoQ0MsT0FBTyxXQUNMLE1BQ0VILE9BQUFJLGNBQUEsT0FBS0MsVUFBVSxXQUNiTCxNQUFBSSxjQUFBLFNBQUlFLEtBQUtDLE1BQU1DLE9BQWYsV0FBK0JGLEtBQUtDLE1BQU1FLGNBSzVDQyxFQUFjVixNQUFNQyxh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bi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdF9fd2VicGFja19yZXF1aXJlX18gKDYpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fICgxKTtcblxuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykge1widXNlIHN0cmljdFwiO1xuXHRcblx0dmFyIF9zdHJpbmdpZnkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHRcblx0dmFyIF9zdHJpbmdpZnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RyaW5naWZ5KTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHQvL2NvbW1lbnRib3guanNcblx0LyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblx0LyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMqL1xuXHR2YXIgQ29tbWVudCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICBkaXNwbGF5TmFtZTogXCJDb21tZW50XCIsXG5cdFxuXHQgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgIFwiZGl2XCIsXG5cdCAgICAgIHsgY2xhc3NOYW1lOiBcImNvbW1lbnRcIiB9LFxuXHQgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgIFwicFwiLFxuXHQgICAgICAgIG51bGwsXG5cdCAgICAgICAgdGhpcy5wcm9wcy5hdXRob3IsXG5cdCAgICAgICAgXCIgc2F5cyAtIFwiLFxuXHQgICAgICAgIHRoaXMucHJvcHMuY2hpbGRyZW5cblx0ICAgICAgKVxuXHQgICAgKTtcblx0ICB9XG5cdH0pO1xuXHR2YXIgQ29tbWVudExpc3QgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgZGlzcGxheU5hbWU6IFwiQ29tbWVudExpc3RcIixcblx0XG5cdCAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICB2YXIgY29tbWVudE5vZGVzID0gdGhpcy5wcm9wcy5kYXRhLm1hcChmdW5jdGlvbiAoY29tbWVudCkge1xuXHQgICAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcblx0ICAgICAgICBDb21tZW50LFxuXHQgICAgICAgIHsgYXV0aG9yOiBjb21tZW50LmF1dGhvciwga2V5OiBjb21tZW50LmlkIH0sXG5cdCAgICAgICAgY29tbWVudC50ZXh0XG5cdCAgICAgICk7XG5cdCAgICB9KTtcblx0ICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFxuXHQgICAgICBcImRpdlwiLFxuXHQgICAgICB7IGNsYXNzTmFtZTogXCJjb21tZW50TGlzdFwiIH0sXG5cdCAgICAgIGNvbW1lbnROb2Rlc1xuXHQgICAgKTtcblx0ICB9XG5cdH0pO1xuXHR2YXIgQ29tbWVudEZvcm0gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgZGlzcGxheU5hbWU6IFwiQ29tbWVudEZvcm1cIixcblx0XG5cdCAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG5cdCAgICByZXR1cm4geyBhdXRob3I6ICcnLCB0ZXh0OiAnJyB9O1xuXHQgIH0sXG5cdCAgaGFuZGxlQXV0aG9yQ2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVBdXRob3JDaGFuZ2UoZSkge1xuXHQgICAgdGhpcy5zZXRTdGF0ZSh7IGF1dGhvcjogZS50YXJnZXQudmFsdWUgfSk7XG5cdCAgfSxcblx0ICBoYW5kbGVUZXh0Q2hhbmdlOiBmdW5jdGlvbiBoYW5kbGVUZXh0Q2hhbmdlKGUpIHtcblx0ICAgIHRoaXMuc2V0U3RhdGUoeyB0ZXh0OiBlLnRhcmdldC52YWx1ZSB9KTtcblx0ICB9LFxuXHQgIGhhbmRsZVN1Ym1pdDogZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcblx0ICAgIGNvbnNvbGUubG9nKFwidGVzdCBub2RlIGRldjogXCIgKyBwcm9jZXNzLmVudi5OT0RFX0VOVik7XG5cdCAgICAvL1N0b3AgYnJvd3NlciBkZWZhdWx0IHN1Ym1pdFxuXHQgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgdmFyIGF1dGhvciA9IHRoaXMuc3RhdGUuYXV0aG9yLnRyaW0oKTtcblx0ICAgIHZhciB0ZXh0ID0gdGhpcy5zdGF0ZS50ZXh0LnRyaW0oKTtcblx0ICAgIGlmICghdGV4dCB8fCAhYXV0aG9yKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblx0ICAgIHZhciBpZCA9IERhdGUubm93KCk7XG5cdCAgICB0aGlzLnByb3BzLm9uQ29udGVudFN1Ym1pdCh7IGlkOiBpZC50b1N0cmluZygpLCBhdXRob3I6IGF1dGhvciwgdGV4dDogdGV4dCB9KTtcblx0ICAgIHRoaXMuc2V0U3RhdGUoeyBhdXRob3I6ICcnLCB0ZXh0OiAnJyB9KTtcblx0ICB9LFxuXHQgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgIFwiZm9ybVwiLFxuXHQgICAgICB7IGNsYXNzTmFtZTogXCJjb21tZW50Rm9ybVwiLCBvblN1Ym1pdDogdGhpcy5oYW5kbGVTdWJtaXQgfSxcblx0ICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHtcblx0ICAgICAgICB0eXBlOiBcInRleHRcIixcblx0ICAgICAgICBwbGFjZWhvbGRlcjogXCJZb3VyIG5hbWVcIixcblx0ICAgICAgICB2YWx1ZTogdGhpcy5zdGF0ZS5hdXRob3IsXG5cdCAgICAgICAgb25DaGFuZ2U6IHRoaXMuaGFuZGxlQXV0aG9yQ2hhbmdlXG5cdCAgICAgIH0pLFxuXHQgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwge1xuXHQgICAgICAgIHR5cGU6IFwidGV4dFwiLFxuXHQgICAgICAgIHBsYWNlaG9sZGVyOiBcIldoYXQgeW91IHdhbnQgdG8gc2F5Li4uXCIsXG5cdCAgICAgICAgdmFsdWU6IHRoaXMuc3RhdGUudGV4dCxcblx0ICAgICAgICBvbkNoYW5nZTogdGhpcy5oYW5kbGVUZXh0Q2hhbmdlXG5cdCAgICAgIH0pLFxuXHQgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgeyB0eXBlOiBcInN1Ym1pdFwiLCB2YWx1ZTogXCJQb3N0XCIgfSlcblx0ICAgICk7XG5cdCAgfVxuXHR9KTtcblx0dmFyIENvbW1lbnRCb3ggPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgZGlzcGxheU5hbWU6IFwiQ29tbWVudEJveFwiLFxuXHRcblx0ICBsb2FkQ29tbWVudHNGcm9tU2VydmVyOiBmdW5jdGlvbiBsb2FkQ29tbWVudHNGcm9tU2VydmVyKCkge1xuXHQgICAgJC5hamF4KHtcblx0ICAgICAgdXJsOiB0aGlzLnByb3BzLnVybCxcblx0ICAgICAgZGF0YVR5cGU6ICdqc29uJyxcblx0ICAgICAgY2FjaGU6IGZhbHNlLFxuXHQgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuXHQgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuXHQgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBkYXRhOiBkYXRhIH0pO1xuXHQgICAgICB9LmJpbmQodGhpcyksXG5cdCAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xuXHQgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5wcm9wcy51cmwsIHN0YXR1cywgZXJyLnRvU3RyaW5nKCkpO1xuXHQgICAgICB9LmJpbmQodGhpcylcblx0ICAgIH0pO1xuXHQgIH0sXG5cdCAgaGFuZGxlQ29tbWVudFN1Ym1pdDogZnVuY3Rpb24gaGFuZGxlQ29tbWVudFN1Ym1pdChjb21tZW50KSB7XG5cdCAgICAvLyBJbnNlcnQgbmV3IGNvbW1lbnQgYW5kIGRlbGV0ZSBsYXN0IG9uZVxuXHQgICAgdGhpcy5zdGF0ZS5kYXRhLnNwbGljZSgwLCAwLCBjb21tZW50KTtcblx0ICAgIHRoaXMuc3RhdGUuZGF0YS5zcGxpY2UoLTEsIDEpO1xuXHQgICAgJC5hamF4KHtcblx0ICAgICAgdXJsOiB0aGlzLnByb3BzLnNlbmRDb21tZW50VXJsLFxuXHQgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuXHQgICAgICB0eXBlOiAnUE9TVCcsXG5cdCAgICAgIGRhdGE6ICgwLCBfc3RyaW5naWZ5Mi5kZWZhdWx0KSh0aGlzLnN0YXRlLmRhdGEpLFxuXHQgICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG5cdCAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG5cdCAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG5cdCAgICAgICAgY29uc29sZS5sb2coXCJBZnRlciBzZW5kaW5nIFwiICsgKDAsIF9zdHJpbmdpZnkyLmRlZmF1bHQpKHRoaXMuc3RhdGUuZGF0YSkpO1xuXHQgICAgICB9LmJpbmQodGhpcyksXG5cdCAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXMsIGVycikge1xuXHQgICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5wcm9wcy5zZW5kQ29tbWVudFVybCwgc3RhdHVzLCBlcnIudG9TdHJpbmcoKSk7XG5cdCAgICAgIH0uYmluZCh0aGlzKVxuXHQgICAgfSk7XG5cdCAgfSxcblx0ICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcblx0ICAgIHJldHVybiB7IGRhdGE6IFtdIH07XG5cdCAgfSxcblx0ICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICB0aGlzLmxvYWRDb21tZW50c0Zyb21TZXJ2ZXIoKTtcblx0ICAgIHNldEludGVydmFsKHRoaXMubG9hZENvbW1lbnRzRnJvbVNlcnZlciwgdGhpcy5wcm9wcy5wb2xsSW50ZXJ2YWwpO1xuXHQgIH0sXG5cdCAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudChcblx0ICAgICAgXCJkaXZcIixcblx0ICAgICAgeyBjbGFzc05hbWU6IFwiY29tbWVudEJveFwiIH0sXG5cdCAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgXCJoMVwiLFxuXHQgICAgICAgIG51bGwsXG5cdCAgICAgICAgXCJIYXZlIHlvdXIgc2F5XCJcblx0ICAgICAgKSxcblx0ICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChDb21tZW50Rm9ybSwgeyBvbkNvbnRlbnRTdWJtaXQ6IHRoaXMuaGFuZGxlQ29tbWVudFN1Ym1pdCB9KSxcblx0ICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChDb21tZW50TGlzdCwgeyBkYXRhOiB0aGlzLnN0YXRlLmRhdGEgfSlcblx0ICAgICk7XG5cdCAgfVxuXHR9KTtcblx0UmVhY3RET00ucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoQ29tbWVudEJveCwge1xuXHQgIHVybDogXCJodHRwczovL3MzLWV1LXdlc3QtMS5hbWF6b25hd3MuY29tL3RoZXBvbGxlbnJlcG9ydC9jb21tZW50cy5qc29uXCIsXG5cdCAgc2VuZENvbW1lbnRVcmw6IChcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdjEvY29tbWVudHNcIiksXG5cdCAgcG9sbEludGVydmFsOiAyMDAwIH0pLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudHMnKSk7XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpKSlcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpLCBfX2VzTW9kdWxlOiB0cnVlIH07XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBjb3JlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0dmFyICRKU09OID0gY29yZS5KU09OIHx8IChjb3JlLkpTT04gPSB7IHN0cmluZ2lmeTogSlNPTi5zdHJpbmdpZnkgfSk7XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3RyaW5naWZ5KGl0KSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnNcblx0ICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpO1xuXHR9O1xuXG5cbi8qKiovIH0pLFxuLyogNCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdHZhciBjb3JlID0gbW9kdWxlLmV4cG9ydHMgPSB7IHZlcnNpb246ICcyLjYuMScgfTtcblx0aWYgKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpIF9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcblxuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcblx0dmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXHRcblx0Ly8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG5cdC8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuXHQvLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG5cdC8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cdFxuXHR2YXIgY2FjaGVkU2V0VGltZW91dDtcblx0dmFyIGNhY2hlZENsZWFyVGltZW91dDtcblx0XG5cdGZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcblx0fVxuXHRmdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG5cdH1cblx0KGZ1bmN0aW9uICgpIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuXHQgICAgICAgIH1cblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcblx0ICAgIH1cblx0ICAgIHRyeSB7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG5cdCAgICAgICAgfVxuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG5cdCAgICB9XG5cdH0gKCkpXG5cdGZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG5cdCAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuXHQgICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuXHQgICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG5cdCAgICB9XG5cdCAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuXHQgICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG5cdCAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG5cdCAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcblx0ICAgIH1cblx0ICAgIHRyeSB7XG5cdCAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuXHQgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG5cdCAgICB9IGNhdGNoKGUpe1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuXHQgICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG5cdCAgICAgICAgfSBjYXRjaChlKXtcblx0ICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3Jcblx0ICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0XG5cdFxuXHR9XG5cdGZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcblx0ICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuXHQgICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuXHQgICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcblx0ICAgIH1cblx0ICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcblx0ICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuXHQgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcblx0ICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG5cdCAgICB9XG5cdCAgICB0cnkge1xuXHQgICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3Ncblx0ICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG5cdCAgICB9IGNhdGNoIChlKXtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG5cdCAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuXHQgICAgICAgIH0gY2F0Y2ggKGUpe1xuXHQgICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cblx0ICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuXHQgICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdFxuXHRcblx0XG5cdH1cblx0dmFyIHF1ZXVlID0gW107XG5cdHZhciBkcmFpbmluZyA9IGZhbHNlO1xuXHR2YXIgY3VycmVudFF1ZXVlO1xuXHR2YXIgcXVldWVJbmRleCA9IC0xO1xuXHRcblx0ZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuXHQgICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgZHJhaW5pbmcgPSBmYWxzZTtcblx0ICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG5cdCAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuXHQgICAgfVxuXHQgICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgIGRyYWluUXVldWUoKTtcblx0ICAgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcblx0ICAgIGlmIChkcmFpbmluZykge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgIH1cblx0ICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuXHQgICAgZHJhaW5pbmcgPSB0cnVlO1xuXHRcblx0ICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG5cdCAgICB3aGlsZShsZW4pIHtcblx0ICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcblx0ICAgICAgICBxdWV1ZSA9IFtdO1xuXHQgICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcblx0ICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuXHQgICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcblx0ICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG5cdCAgICB9XG5cdCAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuXHQgICAgZHJhaW5pbmcgPSBmYWxzZTtcblx0ICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0fVxuXHRcblx0cHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcblx0ICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG5cdCAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuXHQgICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG5cdCAgICB9XG5cdH07XG5cdFxuXHQvLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5cdGZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuXHQgICAgdGhpcy5mdW4gPSBmdW47XG5cdCAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG5cdH1cblx0SXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG5cdH07XG5cdHByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5cdHByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5cdHByb2Nlc3MuZW52ID0ge307XG5cdHByb2Nlc3MuYXJndiA9IFtdO1xuXHRwcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcblx0cHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXHRcblx0ZnVuY3Rpb24gbm9vcCgpIHt9XG5cdFxuXHRwcm9jZXNzLm9uID0gbm9vcDtcblx0cHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5cdHByb2Nlc3Mub25jZSA9IG5vb3A7XG5cdHByb2Nlc3Mub2ZmID0gbm9vcDtcblx0cHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5cdHByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcblx0cHJvY2Vzcy5lbWl0ID0gbm9vcDtcblx0cHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xuXHRwcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXHRcblx0cHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXHRcblx0cHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcblx0fTtcblx0XG5cdHByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5cdHByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xuXHR9O1xuXHRwcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cbi8qKiovIH0pLFxuLyogNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIG1haW4uanNcblx0LyogZXNsaW50LWRpc2FibGUgbm8tdW5kZWYgKi9cblx0JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cdFxuXHQgICAgLy8gZmluZCB0aGUgVVJMIG9mIHlvdXIgSlNPTiBmaWxlIG9uIEFXUyAtIGl0J2xsIGJlIGluIHlvdXIgYnVja2V0XG5cdCAgICAvLyBhbmQgbG9vayBzb21ldGhpbmcgbGlrZSBodHRwczovL3MzLWV1LXdlc3QtMS5hbWF6b25hd3MuY29tL1tidWNrZXQgbmFtZV0vcG9sbGVuLmpzb25cblx0ICAgIC8vIHdlIGxvYWQgdGhlIEpTT04gZmlsZSB1c2luZyBqUXVlcnkncyBBSkFYXG5cdCAgICAkLmdldChcImh0dHBzOi8vczMtZXUtd2VzdC0xLmFtYXpvbmF3cy5jb20vdGhlcG9sbGVucmVwb3J0L3BvbGxlbi5qc29uXCIpXG5cdFxuXHQgICAgLy8gT25jZSB3ZSBoYXZlIHRoZSBkYXRhLCB3ZSBwYXJzZSBpdCB0byBmaW5kIHRoZSBwb2xsZW4gY291bnRcblx0ICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEpIHtcblx0ICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0ICAgICAgICBjb25zdCBwb2xsZW4gPSBkYXRhLmNvdW50O1xuXHRcblx0ICAgICAgICAvLyB1cGRhdGUgdGhlIDxoMSBjbGFzcz1cIm1lZ2FcIj4gd2l0aCB0aGUgcG9sbGVuIGNvdW50XG5cdCAgICAgICAgJCgnLm1lZ2EnKS50ZXh0KHBvbGxlbik7XG5cdCAgICB9KVxuXHRcblx0ICAgIC8vIGlmIHdlIGNvdWxkbid0IGdldCB0aGUgZGF0YSBmcm9tIEFXUywgZGlzcGxheSBhbiBlcnJvciBtZXNzYWdlXG5cdCAgICAuZmFpbChmdW5jdGlvbigpIHtcblx0ICAgICAgICAkKCcubWVnYScpLnRleHQoJ1Vua25vd24nKTtcblx0ICAgICAgICAkKCcubWFpbicpLmFwcGVuZCgnPHA+UmVmcmVzaCB0byB0cnkgYWdhaW48L3A+Jyk7XG5cdCAgICB9KVxuXHRcblx0ICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgLy8gaWYgeW91J3JlIHVzaW5nIGEgbG9hZGluZyBnaWYsIHRoaXMgaXMgd2hlcmUgeW91J2QgaGlkZSBpdFxuXHQgICAgfSk7XG5cdH0pO1xuXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc2NyaXB0cy5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA2NGRmZDY4MWNhZTU4YmUzOGU1YSIsInJlcXVpcmUgKCcuL21haW4uanMnKTtcbnJlcXVpcmUgKCcuL2NvbW1lbnRib3guanMnKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vcHVibGljL2pzL3NjcmlwdHMuanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLy9jb21tZW50Ym94LmpzXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMqL1xuY29uc3QgQ29tbWVudCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgcmVuZGVyOmZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb21tZW50XCI+XG4gICAgICAgIDxwPnt0aGlzLnByb3BzLmF1dGhvcn0gc2F5cyAtIHt0aGlzLnByb3BzLmNoaWxkcmVufTwvcD5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuY29uc3QgQ29tbWVudExpc3QgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIHJlbmRlcjogZnVuY3Rpb24oKXtcbiAgICBjb25zdCBjb21tZW50Tm9kZXMgPSB0aGlzLnByb3BzLmRhdGEubWFwKGZ1bmN0aW9uKGNvbW1lbnQpe1xuICAgICAgcmV0dXJuKFxuICAgICAgICA8Q29tbWVudCBhdXRob3I9e2NvbW1lbnQuYXV0aG9yfSBrZXk9e2NvbW1lbnQuaWR9PlxuICAgICAgICAgIHtjb21tZW50LnRleHR9XG4gICAgICAgIDwvQ29tbWVudD5cbiAgICAgICk7XG4gICAgfSk7XG4gICAgcmV0dXJuKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb21tZW50TGlzdFwiPlxuICAgICAgICB7Y29tbWVudE5vZGVzfVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSk7XG5jb25zdCBDb21tZW50Rm9ybSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xuICAgIHJldHVybnthdXRob3I6ICcnLCB0ZXh0OiAnJ307XG4gIH0sXG4gIGhhbmRsZUF1dGhvckNoYW5nZTogZnVuY3Rpb24oZSl7XG4gICAgdGhpcy5zZXRTdGF0ZSh7YXV0aG9yOiBlLnRhcmdldC52YWx1ZX0pO1xuICB9LFxuICBoYW5kbGVUZXh0Q2hhbmdlOiBmdW5jdGlvbihlKXtcbiAgICB0aGlzLnNldFN0YXRlKHt0ZXh0OiBlLnRhcmdldC52YWx1ZX0pO1xuICB9LFxuICBoYW5kbGVTdWJtaXQ6IGZ1bmN0aW9uKGUpe1xuICAgIGNvbnNvbGUubG9nKFwidGVzdCBub2RlIGRldjogXCIgKyBwcm9jZXNzLmVudi5OT0RFX0VOVik7XG4gICAgLy9TdG9wIGJyb3dzZXIgZGVmYXVsdCBzdWJtaXRcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IGF1dGhvciA9IHRoaXMuc3RhdGUuYXV0aG9yLnRyaW0oKTtcbiAgICBsZXQgdGV4dCA9ICB0aGlzLnN0YXRlLnRleHQudHJpbSgpO1xuICAgIGlmICghdGV4dCB8fCAhYXV0aG9yKXtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGlkID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLnByb3BzLm9uQ29udGVudFN1Ym1pdCh7aWQ6IGlkLnRvU3RyaW5nKCksIGF1dGhvcjogYXV0aG9yLCB0ZXh0OiB0ZXh0fSk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7YXV0aG9yOiAnJywgdGV4dDogJyd9KTtcbiAgfSxcbiAgcmVuZGVyOiBmdW5jdGlvbigpe1xuICAgIHJldHVybihcbiAgICAgIDxmb3JtIGNsYXNzTmFtZT1cImNvbW1lbnRGb3JtXCIgb25TdWJtaXQ9e3RoaXMuaGFuZGxlU3VibWl0fT5cbiAgICAgICAgPGlucHV0XG4gICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiWW91ciBuYW1lXCJcbiAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5hdXRob3J9XG4gICAgICAgICAgb25DaGFuZ2U9e3RoaXMuaGFuZGxlQXV0aG9yQ2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgICA8aW5wdXRcbiAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJXaGF0IHlvdSB3YW50IHRvIHNheS4uLlwiXG4gICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUudGV4dH1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5oYW5kbGVUZXh0Q2hhbmdlfVxuICAgICAgICAvPlxuICAgICAgICA8aW5wdXQgdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiUG9zdFwiIC8+XG4gICAgICA8L2Zvcm0+XG4gICAgKTtcbiAgfVxufSk7XG5jb25zdCBDb21tZW50Qm94ID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBsb2FkQ29tbWVudHNGcm9tU2VydmVyOiBmdW5jdGlvbigpe1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6IHRoaXMucHJvcHMudXJsLFxuICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2RhdGE6IGRhdGF9KTtcbiAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5wcm9wcy51cmwsIHN0YXR1cywgZXJyLnRvU3RyaW5nKCkpO1xuICAgICAgfS5iaW5kKHRoaXMpXG4gICAgfSk7XG4gIH0sXG4gIGhhbmRsZUNvbW1lbnRTdWJtaXQ6IGZ1bmN0aW9uKGNvbW1lbnQpe1xuICAgIC8vIEluc2VydCBuZXcgY29tbWVudCBhbmQgZGVsZXRlIGxhc3Qgb25lXG4gICAgdGhpcy5zdGF0ZS5kYXRhLnNwbGljZSgwLCAwLCBjb21tZW50KTtcbiAgICB0aGlzLnN0YXRlLmRhdGEuc3BsaWNlKC0xLCAxKTtcbiAgICAkLmFqYXgoe1xuICAgICAgdXJsOiB0aGlzLnByb3BzLnNlbmRDb21tZW50VXJsLFxuICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHRoaXMuc3RhdGUuZGF0YSksXG4gICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkFmdGVyIHNlbmRpbmcgXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnN0YXRlLmRhdGEpKTtcbiAgICAgIH0uYmluZCh0aGlzKSxcbiAgICAgIGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IodGhpcy5wcm9wcy5zZW5kQ29tbWVudFVybCwgc3RhdHVzLCBlcnIudG9TdHJpbmcoKSk7XG4gICAgICB9LmJpbmQodGhpcylcbiAgICB9KTtcbiAgfSxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xuICAgIHJldHVybiB7ZGF0YTogW119O1xuICB9LFxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5sb2FkQ29tbWVudHNGcm9tU2VydmVyKCk7XG4gICAgc2V0SW50ZXJ2YWwodGhpcy5sb2FkQ29tbWVudHNGcm9tU2VydmVyLCB0aGlzLnByb3BzLnBvbGxJbnRlcnZhbCk7XG4gIH0sXG4gIHJlbmRlcjogZnVuY3Rpb24oKXtcbiAgICByZXR1cm4oXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbW1lbnRCb3hcIj5cbiAgICAgICAgPGgxPkhhdmUgeW91ciBzYXk8L2gxPlxuICAgICAgICA8Q29tbWVudEZvcm0gb25Db250ZW50U3VibWl0PXt0aGlzLmhhbmRsZUNvbW1lbnRTdWJtaXR9Lz5cbiAgICAgICAgPENvbW1lbnRMaXN0IGRhdGE9e3RoaXMuc3RhdGUuZGF0YX0vPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSk7XG5SZWFjdERPTS5yZW5kZXIoXG4gIDxDb21tZW50Qm94XG4gICAgdXJsPVwiaHR0cHM6Ly9zMy1ldS13ZXN0LTEuYW1hem9uYXdzLmNvbS90aGVwb2xsZW5yZXBvcnQvY29tbWVudHMuanNvblwiXG4gICAgc2VuZENvbW1lbnRVcmw9e0NPTU1FTlRTX0FQSV9VUkx9XG4gICAgcG9sbEludGVydmFsPXsyMDAwfS8+LFxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWVudHMnKVxuKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3B1YmxpYy9qcy9jb21tZW50Ym94LmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL2pzb24vc3RyaW5naWZ5XCIpLCBfX2VzTW9kdWxlOiB0cnVlIH07XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9qc29uL3N0cmluZ2lmeS5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgY29yZSA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKTtcbnZhciAkSlNPTiA9IGNvcmUuSlNPTiB8fCAoY29yZS5KU09OID0geyBzdHJpbmdpZnk6IEpTT04uc3RyaW5naWZ5IH0pO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdHJpbmdpZnkoaXQpIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFyc1xuICByZXR1cm4gJEpTT04uc3RyaW5naWZ5LmFwcGx5KCRKU09OLCBhcmd1bWVudHMpO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jb3JlLWpzL2xpYnJhcnkvZm4vanNvbi9zdHJpbmdpZnkuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHsgdmVyc2lvbjogJzIuNi4xJyB9O1xuaWYgKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpIF9fZSA9IGNvcmU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY29yZS5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L3Byb2Nlc3MvYnJvd3Nlci5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBtYWluLmpzXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cbiAgICAvLyBmaW5kIHRoZSBVUkwgb2YgeW91ciBKU09OIGZpbGUgb24gQVdTIC0gaXQnbGwgYmUgaW4geW91ciBidWNrZXRcbiAgICAvLyBhbmQgbG9vayBzb21ldGhpbmcgbGlrZSBodHRwczovL3MzLWV1LXdlc3QtMS5hbWF6b25hd3MuY29tL1tidWNrZXQgbmFtZV0vcG9sbGVuLmpzb25cbiAgICAvLyB3ZSBsb2FkIHRoZSBKU09OIGZpbGUgdXNpbmcgalF1ZXJ5J3MgQUpBWFxuICAgICQuZ2V0KFwiaHR0cHM6Ly9zMy1ldS13ZXN0LTEuYW1hem9uYXdzLmNvbS90aGVwb2xsZW5yZXBvcnQvcG9sbGVuLmpzb25cIilcblxuICAgIC8vIE9uY2Ugd2UgaGF2ZSB0aGUgZGF0YSwgd2UgcGFyc2UgaXQgdG8gZmluZCB0aGUgcG9sbGVuIGNvdW50XG4gICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgY29uc3QgcG9sbGVuID0gZGF0YS5jb3VudDtcblxuICAgICAgICAvLyB1cGRhdGUgdGhlIDxoMSBjbGFzcz1cIm1lZ2FcIj4gd2l0aCB0aGUgcG9sbGVuIGNvdW50XG4gICAgICAgICQoJy5tZWdhJykudGV4dChwb2xsZW4pO1xuICAgIH0pXG5cbiAgICAvLyBpZiB3ZSBjb3VsZG4ndCBnZXQgdGhlIGRhdGEgZnJvbSBBV1MsIGRpc3BsYXkgYW4gZXJyb3IgbWVzc2FnZVxuICAgIC5mYWlsKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcubWVnYScpLnRleHQoJ1Vua25vd24nKTtcbiAgICAgICAgJCgnLm1haW4nKS5hcHBlbmQoJzxwPlJlZnJlc2ggdG8gdHJ5IGFnYWluPC9wPicpO1xuICAgIH0pXG5cbiAgICAuYWx3YXlzKGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBpZiB5b3UncmUgdXNpbmcgYSBsb2FkaW5nIGdpZiwgdGhpcyBpcyB3aGVyZSB5b3UnZCBoaWRlIGl0XG4gICAgfSk7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vcHVibGljL2pzL21haW4uanNcbi8vIG1vZHVsZSBpZCA9IDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==